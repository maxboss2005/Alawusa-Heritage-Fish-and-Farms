<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Home | Alawusa Heritage Fish & Farms</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Alegreya:ital,wght@0,400..900;1,400..900&display=swap"
      rel="stylesheet"
    />
    <!-- AOS CSS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <link
      rel="shortcut icon"
      href="Alawusa heritage icon - Icon.png"
      type="img"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta
      name="description"
      content="Alawusa Heritage Fish & Farms offers premium catfish, frozen fish, fresh farm products, farming tips, and online ordering nationwide."
    />
    <meta
      name="keywords"
      content="Alawusa Heritage, fish farm Nigeria, catfish farm, Alawusa, Alawusa fish, farms in Lagos, fish supply Nigeria"
    />
    <meta name="author" content="Alawusa Heritage Fish & Farms" />

    <meta property="og:title" content="Alawusa Heritage Fish & Farms" />
    <meta
      property="og:description"
      content="Premium catfish and farm products delivered fresh."
    />
    <meta property="og:url" content="https://alawusaheritage.com.ng" />
    <meta property="og:type" content="website" />

    <script type="module" src="homepage.js"></script>
    <style>
      /* Loading Screen Styles */
      .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: white;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        transition: opacity 0.5s ease, visibility 0.5s ease;
      }

      .loading-screen.hidden {
        opacity: 0;
        visibility: hidden;
      }

      .loading-logo {
        width: 200px;
        height: auto;
        margin-bottom: 30px;
        animation: pulse 2s infinite ease-in-out;
      }

      .loading-spinner {
        width: 50px;
        height: 50px;
        border: 3px solid #f3f3f3;
        border-top: 3px solid #2e802e;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
      }

      .loading-text {
        font-family: "Poppins", sans-serif;
        color: #2e802e;
        font-size: 18px;
        font-weight: 500;
        letter-spacing: 1px;
      }

      .loading-progress {
        width: 200px;
        height: 3px;
        background: #f0f0f0;
        margin-top: 20px;
        border-radius: 2px;
        overflow: hidden;
      }

      .loading-progress-bar {
        height: 100%;
        background: #2e802e;
        width: 0%;
        transition: width 0.3s ease;
        border-radius: 2px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
          opacity: 1;
        }
        50% {
          transform: scale(1.05);
          opacity: 0.8;
        }
      }

      
      :root {
        --primary-color: #1a4d2e;
        --secondary-color: #28a745;
        --accent-color: #ffc107;
        --light-bg: #f9f9f9;
        --dark-text: #333;
        --light-text: #fff;
        --border-radius: 8px;
        --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        --transition: all 0.3s ease;
      }
      /* Reset and Base Styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        max-width: 100%;
        overflow-x: hidden;
        font-family: "Poppins", sans-serif;
        line-height: 1.6;
        color: #333;
        opacity: 0;
        animation: fadeIn 0.5s ease forwards;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      /* Header Styles */
      .main-header {
        position: sticky;
        top: 0;
        z-index: 1000;
        background: white;
        box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
      }

      .top-bar {
        background: #2e802e;
        color: white;
        padding: 8px 20px;
        font-size: 14px;
        text-align: center;
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
      }

      .contact-info span {
        margin: 0 10px;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 5%;
        background-color: #fff;
      }

      .logo img {
        width: 100px;
        height: auto;
      }

      /* Navigation */
      .desktop-nav ul {
        display: flex;
        list-style: none;
        gap: 25px;
      }

      .desktop-nav ul li a {
        text-decoration: none;
        font-weight: 600;
        color: #444;
        transition: color 0.3s;
        font-size: 16px;
        position: relative;
      }

      .desktop-nav ul li a:hover,
      .desktop-nav ul li a.active {
        color: #15921b;
      }

      .desktop-nav ul li a::after {
        content: "";
        position: absolute;
        width: 0;
        height: 2px;
        bottom: -5px;
        left: 0;
        background-color: #15921b;
        transition: width 0.3s ease;
      }

      .desktop-nav ul li a:hover::after {
        width: 100%;
      }

      .header-right {
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .shopping-cart {
        position: relative;
        display: flex;
        align-items: center;
      }

      .cart-count {
        background: #e74c3c;
        color: white;
        border-radius: 50%;
        padding: 2px 6px;
        font-size: 12px;
        position: absolute;
        top: -8px;
        right: -8px;
        min-width: 18px;
        text-align: center;
      }

      .menu-icon {
        display: none;
        font-size: 24px;
        cursor: pointer;
        color: #444;
      }

      /* Hero Section */
      .hero {
        position: relative;
        height: 70vh;
        background: url("background\ pic\ 1.webp") center/cover no-repeat;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        margin-top: 0;
      }

      .hero::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.45);
      }

      .hero-content {
        position: relative;
        color: white;
        max-width: 800px;
        padding: 0 20px;
      }

      .hero-content h1 {
        font-size: 3.5rem;
        font-weight: 700;
        margin-bottom: 20px;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
      }

      .hero-content p {
        font-size: 1.3rem;
        margin-bottom: 15px;
        color: #f0f0f0;
      }

      .btn {
        display: inline-block;
        padding: 12px 30px;
        background-color: #4caf50;
        color: white;
        text-decoration: none;
        font-weight: bold;
        border-radius: 30px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        margin-bottom: 15px;
        transition: background-color 0.3s, transform 0.3s, box-shadow 0.3s;
      }

      .btn:hover {
        background-color: #388e3c;
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      }

      .btn-sm {
        display: inline-block;
        padding: 12px 30px;
        border: 1px solid green;
        border-radius: 30px;
        text-decoration: none;
        color: rgb(68, 68, 68);
        font-weight: bold;
        transition: background-color 0.3s, color 0.3s, border 0.3s;
      }

      .btn-sm:hover {
        background-color: #4caf50;
        color: white;
        border: none;
      }

      /* Categories Section */
      .categories {
        padding: 80px 0;
        background: #f9f9f9;
      }

      .small-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      .title {
        font-family: "Poppins", sans-serif;
        color: #2e802e;
        text-align: center;
        margin: 0 auto 60px;
        position: relative;
        font-size: 2.2rem;
        font-weight: 600;
      }

      .title::after {
        content: "";
        background: #ff6b6b;
        width: 80px;
        height: 4px;
        border-radius: 2px;
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
      }

      .row {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 30px;
      }

      .col-3 {
        flex: 1;
        min-width: 250px;
        max-width: 300px;
        text-align: center;
        transition: transform 0.3s;
      }

      .col-3:hover {
        transform: translateY(-10px);
      }

      .col-3 img {
        width: 100%;
        height: 200px;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s;
      }

      .col-3:hover img {
        transform: scale(1.05);
      }

      .col-3 h4 {
        margin-top: 15px;
        font-size: 1.2rem;
        color: #444;
        font-weight: 600;
      }

      /* Products Section */
      .products-section {
        padding: 80px 0;
      }

      .col-4 {
        flex: 1;
        min-width: 250px;
        max-width: 280px;
        background: white;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        transition: all 0.3s;
        margin-bottom: 30px;
      }

      .col-4:hover {
        transform: translateY(-10px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      }

      .col-4 img {
        width: 100%;
        height: 200px;
      }

      .product-info {
        padding: 20px;
      }

      .col-4 h4 {
        font-size: 1.1rem;
        margin-bottom: 10px;
        color: #333;
        font-weight: 600;
      }

      .rating {
        color: #ffc107;
        margin-bottom: 10px;
      }

      .price {
        font-size: 1.2rem;
        font-weight: 600;
        color: #2e802e;
      }

      /* Slideshow Section */
      .slideshow-section {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 40px;
        padding: 60px 5%;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        margin: 80px 0;
      }

      .slideshow-left {
        flex: 1;
        position: relative;
        height: 350px;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      .fade-slide {
        position: absolute;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: opacity 1s ease-in-out;
      }

      .fade-slide.active {
        opacity: 1;
      }

      .fade-slide img {
        width: 100%;
        height: 100%;
      }

      .slideshow-right {
        flex: 1;
        padding: 0 20px;
      }

      .slideshow-right h2 {
        font-size: 2.2rem;
        margin-bottom: 20px;
        color: #2e802e;
        font-weight: 600;
      }

      .slideshow-right p {
        font-size: 1.1rem;
        margin-bottom: 25px;
        color: #555;
        line-height: 1.6;
      }

      /* Agencies Section */
      .agencies {
        padding: 80px 0;
        background: #f9f9f9;
      }

      .agency-logos {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        gap: 40px;
      }

      .agency-logos img {
        height: 80px;
        width: auto;
        filter: grayscale(0%);
        opacity: 1;
        transition: all 0.3s;
      }

      .agency-logos img:hover {
        filter: grayscale(100%);
        opacity: 1;
      }

      /* Footer */
      .footer {
        background: #0f2c0f;
        color: #8a8a8a;
        padding: 60px 0 20px;
      }

      .footer-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
      }

      .footer-col {
        flex: 1;
        min-width: 250px;
        margin-bottom: 30px;
      }

      .footer-col h3 {
        color: #fff;
        margin-bottom: 20px;
        font-size: 1.3rem;
        font-weight: 600;
      }

      .footer-col ul {
        list-style: none;
      }

      .footer-col ul li {
        margin-bottom: 10px;
      }

      .footer-col ul li a {
        color: #8a8a8a;
        text-decoration: none;
        transition: color 0.3s;
      }

      .footer-col ul li a:hover {
        color: #4caf50;
      }

      .social-links {
        display: flex;
        gap: 15px;
        margin-top: 20px;
      }

      .social-links a {
        display: inline-block;
        width: 40px;
        height: 40px;
        background: #333;
        border-radius: 50%;
        text-align: center;
        line-height: 40px;
        color: white;
        transition: all 0.3s;
      }

      .social-links a:hover {
        background: #4caf50;
        transform: translateY(-3px);
      }

      .copyright {
        text-align: center;
        padding-top: 20px;
        margin-top: 40px;
        border-top: 1px solid #333;
        color: #8a8a8a;
        font-size: 14px;
      }

      /* Mobile Menu */
      .mobile-menu {
        position: fixed;
        top: 0;
        right: -100%;
        width: 280px;
        height: 100%;
        background: #1a4720;
        z-index: 2000;
        transition: right 0.4s ease;
        overflow-y: auto;
        padding: 20px;
      }

      .mobile-menu.open {
        right: 0;
      }

      .mobile-menu .close-btn {
        background: none;
        border: none;
        color: white;
        font-size: 28px;
        position: absolute;
        top: 15px;
        right: 20px;
        cursor: pointer;
      }

      .mobile-menu ul {
        list-style: none;
        margin-top: 60px;
      }

      .mobile-menu ul li {
        margin-bottom: 15px;
      }

      .mobile-menu ul li a {
        color: white;
        text-decoration: none;
        font-size: 18px;
        display: block;
        padding: 10px;
        border-radius: 5px;
        transition: background 0.3s;
      }

      .mobile-menu ul li a:hover {
        background: #2e802e;
      }

      .accordion-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.4s ease;
        padding-left: 20px;
      }

      .accordion-content.open {
        max-height: 200px;
      }

      /* Responsive Styles */
      @media (max-width: 1024px) {
        .hero-content h1 {
          font-size: 2.8rem;
        }

        .slideshow-section {
          flex-direction: column;
          text-align: center;
        }

        .slideshow-left {
          width: 100%;
          margin-bottom: 30px;
        }
      }

      @media (max-width: 1000px) {
        .desktop-nav {
          display: none;
        }
        .menu-icon {
          display: block;
        }
      }

      @media (max-width: 768px) {
        .top-bar {
          flex-direction: column;
          gap: 5px;
          font-size: 12px;
        }

        .desktop-nav {
          display: none;
        }

        .menu-icon {
          display: block;
        }

        .hero {
          height: 60vh;
        }

        .hero-content h1 {
          font-size: 2.2rem;
        }

        .hero-content p {
          font-size: 1.1rem;
        }

        .title {
          font-size: 1.8rem;
        }

        .slideshow-right h2 {
          font-size: 1.8rem;
        }
      }

      @media (max-width: 480px) {
        .hero {
          height: 50vh;
        }

        .hero-content h1 {
          font-size: 1.8rem;
        }

        .btn {
          padding: 10px 20px;
          font-size: 14px;
        }

        .btn-sm {
          padding: 10px 20px;
          font-size: 14px;
        }

        .title {
          font-size: 1.6rem;
        }

        .col-3,
        .col-4 {
          min-width: 100%;
        }
      }

      /* Footer */
      .footer {
        background: var(--primary-color);
        color: var(--light-text);
        padding: 60px 0 20px;
      }

      .footer-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        gap: 40px;
        margin-bottom: 40px;
      }

      .footer-col {
        flex: 1;
        min-width: 200px;
      }

      .footer-col h3 {
        font-size: 20px;
        margin-bottom: 20px;
        position: relative;
        padding-bottom: 10px;
      }

      .footer-col h3::after {
        content: "";
        position: absolute;
        left: 0;
        bottom: 0;
        width: 50px;
        height: 2px;
        background: var(--secondary-color);
      }

      .footer-col ul {
        list-style: none;
      }

      .footer-col ul li {
        margin-bottom: 10px;
      }

      .footer-col ul li a {
        color: #ddd;
        text-decoration: none;
        transition: var(--transition);
      }

      .footer-col ul li a:hover {
        color: var(--secondary-color);
        padding-left: 5px;
      }

      .social-links {
        display: flex;
        gap: 15px;
        margin-top: 20px;
      }

      .social-links a {
        display: inline-block;
        width: 40px;
        height: 40px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: var(--transition);
      }

      .social-links a:hover {
        background: var(--secondary-color);
        transform: translateY(-3px);
      }

      .social-links img {
        width: 20px;
        height: 20px;
      }

      .copyright {
        text-align: center;
        padding-top: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        font-size: 14px;
        color: #aaa;
      }

      /* Newsletter Section */
      .newsletter-section {
        background: #041e42;
        color: white;
        padding: 50px 20px;
        margin-bottom: 40px;
        margin: 5px;
        border-radius: 2px;
      }

      .newsletter-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap; 
        gap: 20px;
        width: 100%;
        margin: 10px;
      }

      .newsletter-text {
        flex: 1 1 300px; 
      }

      .newsletter-form {
        display: flex;
        flex: 1 1 300px;
        max-width: 500px;
        width: 100%;
      }

      .newsletter-form input {
        flex: 1;
        padding: 12px 10px;
        border: none;
        border-radius: 4px 0 0 4px;
        font-size: 1rem;
        min-width: 0; 
      }

      .newsletter-form button {
        background: #15921b;
        color: white;
        border: none;
        padding: 0 20px;
        border-radius: 0 4px 4px 0;
        cursor: pointer;
        transition: background 0.3s ease;
        white-space: nowrap; 
      }

      .newsletter-form button:hover {
        background: #117a15;
      }

      ul li i {
        margin-right: 6px;
        color: var(--secondary-color);
        font-size: 16px;
      }

      #userName2 {
        color: #fff;
      }

      .user-actions {
        position: relative;
        cursor: pointer;
      }

      .user-dropdown {
        position: absolute;
        top: 100%;
        right: -150px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
        min-width: 200px;
        padding: 15px 0;
        z-index: 1001;
        display: none;
        margin-top: 10px;
      }

      .user-dropdown.active {
        display: block;
        animation: dropdownFade 0.3s ease;
      }

      @keyframes dropdownFade {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .user-dropdown::before {
        content: "";
        position: absolute;
        top: -8px;
        right: 20px;
        width: 0;
        height: 0;
        border-left: 8px solid transparent;
        border-right: 8px solid transparent;
        border-bottom: 8px solid white;
      }

      .user-dropdown a {
        display: block;
        padding: 10px 20px;
        color: #333;
        font-size: 14px;
        transition: all 0.3s ease;
      }

      .user-dropdown a:hover {
        background: #f5f5f5;
        color: #2e7d32;
      }

      .user-dropdown a i {
        margin-right: 8px;
        width: 16px;
        text-align: center;
      }

      @media (max-width: 768px) {
        .user-dropdown {
          left: -10px;
          right: -10px;
          background-color: #444;
        }

        .user-dropdown a {
          color: black;
        }
      }

      /* Newsletter Success Popup */
      #newsletterPopup .popup-content {
        max-width: 450px;
        padding: 30px;
      }

      #newsletterPopup h2 {
        color: #2e802e;
        margin-bottom: 15px;
      }

      #newsletterPopup p {
        color: #555;
        margin-bottom: 10px;
        line-height: 1.5;
      }

      /* Popup */
      .popup {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 3000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s;
      }

      .popup.active {
        opacity: 1;
        visibility: visible;
      }

      .popup-content {
        background: white;
        padding: 30px;
        border-radius: 10px;
        max-width: 400px;
        width: 90%;
        text-align: center;
        position: relative;
        transform: scale(0.9);
        transition: transform 0.3s;
      }

      .popup.active .popup-content {
        transform: scale(1);
      }

      .popup .close-btn {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 24px;
        cursor: pointer;
        color: #777;
        background: none;
        border: none;
      }

      .popup img {
        width: 100px;
        margin-bottom: 15px;
      }

      .popup h2 {
        margin-bottom: 15px;
        color: #2e802e;
      }

      .popup p {
        margin-bottom: 20px;
        color: #555;
      }

      /* Hidden class for dynamic content */
      .hidden {
        display: none !important;
      }

      /* Admin link styling */
.desktop-nav ul li a.admin-link,
#mobileMenu ul li a.admin-link {
    color: #ff6b6b !important;
    font-weight: bold !important;
}

.desktop-nav ul li a.admin-link::after {
    background-color: #ff6b6b !important;
}

/* Admin badge */
.user-actions .admin-badge {
    background: #ff6b6b;
    color: white;
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 10px;
    margin-left: 5px;
    vertical-align: middle;
}

/* ========== NOTIFICATION STYLES ========== */
.notifications {
    position: relative;
    cursor: pointer;
    color: #555;
    padding: 8px;
    border-radius: 4px;
    transition: var(--transition);
}

.notifications:hover {
    background: #f5f5f5;
    color: var(--primary-color);
}

.notification-count {
    position: absolute;
    top: -5px;
    right: -5px;
    background: #f44336;
    color: white;
    font-size: 11px;
    font-weight: bold;
    padding: 2px 6px;
    border-radius: 50%;
    min-width: 18px;
    text-align: center;
}

.notifications-dropdown {
    position: absolute;
    top: 100%;
    right: 0;
    background: white;
    border-radius: 8px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    width: 350px;
    max-height: 400px;
    overflow-y: auto;
    z-index: 1002;
    display: none;
    margin-top: 10px;
}

.notifications-dropdown.active {
    display: block;
    animation: dropdownFade 0.3s ease;
}

@keyframes dropdownFade {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.notifications-dropdown::before {
    content: "";
    position: absolute;
    top: -8px;
    right: 20px;
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-bottom: 8px solid white;
}

.notifications-header {
    padding: 15px;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.notifications-header h4 {
    margin: 0;
    color: var(--primary-color);
}

.notifications-header button {
    background: none;
    border: none;
    color: var(--secondary-color);
    cursor: pointer;
    font-size: 12px;
    padding: 5px 10px;
    border-radius: 4px;
    transition: var(--transition);
}

.notifications-header button:hover {
    background: #f5f5f5;
}

.notifications-list {
    max-height: 300px;
    overflow-y: auto;
}

.notification-item {
    padding: 12px 15px;
    border-bottom: 1px solid #f0f0f0;
    cursor: pointer;
    transition: var(--transition);
}

.notification-item:hover {
    background: #f8f9fa;
}

.notification-item.unread {
    background: #f0f7ff;
}

.notification-message {
    font-size: 14px;
    margin-bottom: 5px;
}

.notification-time {
    font-size: 11px;
    color: #888;
}

.notifications-footer {
    padding: 10px 15px;
    text-align: center;
    border-top: 1px solid #eee;
}

.notifications-footer a {
    color: var(--primary-color);
    text-decoration: none;
    font-size: 14px;
}

.notifications-footer a:hover {
    text-decoration: underline;
}

/* In-page notification styles */
.in-page-notification {
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--primary-color);
    color: white;
    padding: 15px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    z-index: 9999;
    max-width: 350px;
    animation: slideIn 0.3s ease;
    cursor: pointer;
    transition: transform 0.3s ease;
}

@keyframes slideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes slideOut {
    from {
        transform: translateX(0);
        opacity: 1;
    }
    to {
        transform: translateX(100%);
        opacity: 0;
    }
}

.unread-badge {
    background: #f44336;
    color: white;
    font-size: 9px;
    padding: 2px 5px;
    border-radius: 10px;
    margin-left: 8px;
    font-weight: bold;
}

.notifications.has-notifications .fa-bell {
    color: #f44336;
    animation: bellRing 1s ease;
}

@keyframes bellRing {
    0%, 100% { transform: rotate(0); }
    10%, 30%, 50%, 70%, 90% { transform: rotate(-10deg); }
    20%, 40%, 60%, 80% { transform: rotate(10deg); }
}

/* Mobile responsiveness for notifications */
@media (max-width: 768px) {
    .notifications-dropdown {
        position: fixed;
        width: 90vw;
        max-width: 350px;
        left: 50%;
        right: auto;
        transform: translateX(-50%);
        top: 80px;
        margin-top: 0;
        max-height: 60vh;
    }
    
    .notifications-dropdown::before {
        right: 50%;
        transform: translateX(50%);
    }
}

@media (max-width: 480px) {
    .notifications-dropdown {
        width: 95vw;
    }
}
    </style>
  </head>

  <body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
      <img
        src="Alawusa heritage logo.png"
        alt="Alawusa Heritage"
        class="loading-logo"
      />
      <div class="loading-spinner"></div>
      <div class="loading-text">LOADING</div>
      <div class="loading-progress">
        <div class="loading-progress-bar" id="loadingProgress"></div>
      </div>
    </div>

    

    

    

    <!-- Sign Up Popup (For Non-Registered Users) -->
    <div id="popup" class="popup">
      <div class="popup-content">
        <span class="close-btn" id="closePopup">&times;</span>
        <img src="register now.webp" alt="Exclusive Offer" />
        <h2>Become a Valued Member!</h2>
        <p>
          Sign up now and enjoy exclusive deals, farm-fresh updates, and premium
          benefits.
        </p>
        <button id="registerBtn" class="btn">
          Sign Up Now <i class="fas fa-users"></i>
        </button>
      </div>
    </div>

    <!-- Header -->
    <header class="main-header">
      <div class="header">
        <div class="logo">
          <a href="index.html"
            ><img src="Alawusa heritage logo.png" alt="Alawusa Heritage"
          /></a>
        </div>

        <!-- Desktop Menu -->
        <nav class="desktop-nav">
          <ul>
            <!-- Registered User Section (Hidden by default) -->
            <li id="registeredUserSection" class="hidden">
              <!-- User Dropdown -->
              <div class="user-actions">
                <p id="userDropdownToggle">
                  <i class="fas fa-user-circle"></i>
                  <span id="userName">Customer</span>
                  <i
                    class="fas fa-chevron-down"
                    style="font-size: 12px; margin-left: 5px"
                  ></i>
                </p>
                <div class="user-dropdown" id="userDropdown">
                  <a href="index.html"><i class="fas fa-home"></i> Home</a>
                  <a href="homepage.html"
                    ><i class="fas fa-user"></i> My Profile</a
                  >
                  <a href="userorders.html"
                    ><i class="fas fa-shopping-bag"></i> My Orders</a
                  >
                  <a href="wishlist.html"
                    ><i class="fas fa-heart"></i> Wishlist</a
                  >
                  <a href="userfaq.html"
                    ><i class="fas fa-question-circle"></i> Help Center</a
                  >
                  <a href="#" id="logoutButtonOne"
                    ><i class="fas fa-sign-out-alt"></i> Logout</a
                  >
                </div>
              </div>
            </li>

            <li><a href="index.html" class="active">Home</a></li>
            
            <!-- Products Link (Different for registered/non-registered) -->
            <li><a href="products.html" id="productsLink">Products</a></li>
            
            <li><a href="aboutus.html" id="aboutLink">About Us</a></li>
            <li><a href="contact.html" id="contactLink">Contact</a></li>
            
            <!-- Profile/Account Link (Different for registered/non-registered) -->
            <li><a href="account.html" id="profileLink">Account</a></li>
          </ul>
        </nav>

        <!-- Find this section in index.html -->
<div class="header-right">
    <!-- Add notifications bell BEFORE cart -->
    <div class="notifications" id="notificationsBell">
        <i class="fas fa-bell"></i>
        <span class="notification-count" id="notificationCount">0</span>
        
        <!-- Notifications dropdown -->
        <div class="notifications-dropdown" id="notificationsDropdown">
            <div class="notifications-header">
                <h4>Notifications</h4>
                <button id="markAllRead">Mark all as read</button>
            </div>
            <div class="notifications-list" id="notificationsList">
                <!-- Notifications will be loaded here -->
            </div>
            <div class="notifications-footer">
                <a href="userorders.html" id="viewAllNotifications">View All</a>
            </div>
        </div>
    </div>
    
    <!-- Cart -->
    <a href="cart.html" id="cartLink" class="shopping-cart">
        <img src="shopping-cart.png" width="30" height="30" alt="Cart" />
        <span id="cart-count" class="cart-count">0</span>
    </a>
    <div class="menu-icon" onclick="openMenu()">☰</div>
</div>
      </div>
    </header>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="mobile-menu">
      <button class="close-btn" onclick="closeMenu()">×</button>
      <ul>
        <!-- Registered User Section (Hidden by default) -->
        <li id="registeredUserSectionMobile" class="hidden">
          <!-- User Dropdown -->
          <div class="user-actions">
            <p id="userDropdownToggleMobile">
              <i class="fas fa-user-circle"></i>
              <span id="userName2">Customer</span>
              <i
                class="fas fa-chevron-down"
                style="font-size: 12px; margin-left: 5px"
              ></i>
            </p>
            <div class="user-dropdown" id="userDropdownMobile">
              <a href="index.html"><i class="fas fa-home"></i> Home</a>
              <a href="homepage.html"><i class="fas fa-user"></i> My Profile</a>
              <a href="userorders.html"
                ><i class="fas fa-shopping-bag"></i> My Orders</a
              >
              <a href="wishlist.html"><i class="fas fa-heart"></i> Wishlist</a>
              <a href="userfaq.html"
                ><i class="fas fa-question-circle"></i> Help Center</a
              >
              <a href="#" id="logoutButton"
                ><i class="fas fa-sign-out-alt"></i> Logout</a
              >
            </div>
          </div>
        </li>
        
        <li><a href="index.html">Home</a></li>
        <li><a href="products.html" id="productsLinkMobile">Products</a></li>
        <li><a href="aboutus.html" id="aboutLinkMobile">About Us</a></li>
        <li><a href="contact.html" id="contactLinkMobile">Contact</a></li>
        <li><a href="testimonial.html" id="reviewsLinkMobile">Reviews</a></li>
        <li><a href="account.html" id="profileLinkMobile">Account</a></li>
      </ul>
    </div>

    <!-- Hero Section -->
    <section class="hero">
      <div class="hero-content" data-aos="fade-up">
        <h1>Providing High-quality, Farm-fresh Solutions</h1>
        <p>
          Building on over 40 years of family legacy in sustainable agriculture
          and innovating Nigeria's food supply
        </p>
        <a href="#categories" class="btn"
          >Explore Now <i class="fas fa-arrow-right"></i
        ></a>
      </div>
    </section>

    <!-- Categories Section -->
    <section class="categories" id="categories">
      <div class="small-container">
        <h2 class="title">Featured Categories</h2>
        <div class="row">
          <div class="col-3" data-aos="fade-up">
            <a href="productdetailsforlivechicken.html" id="liveChickenLink">
              <img src="Live chicken sticker.png" alt="Live Chicken" />
            </a>
            <h4>LIVE CHICKEN</h4>
          </div>
          <div class="col-3" data-aos="fade-up">
            <a href="productdetailsforrayfish.html" id="rayfishLink">
              <img src="Ray fish sticker.png" alt="Ray Fish" />
            </a>
            <h4>RAY-FISH</h4>
          </div>
          <div class="col-3" data-aos="fade-up">
            <a href="productdetailsforlivepigs.html" id="livePigsLink">
              <img src="pig sticker.png" alt="Live Pigs" />
            </a>
            <h4>LIVE PIGS</h4>
          </div>
        </div>
      </div>
    </section>

    <!-- Featured Products -->
    <section class="products-section">
      <div class="small-container">
        <h2 class="title" id="fproducts">Featured Products</h2>
        <div class="row">
          <div class="col-4" data-aos="fade-up">
            <a href="productdetailsforpork.html" id="porkLink">
              <img src="Pork sticker.png" alt="Pork" />
            </a>
            <div class="product-info">
              <h4>ALAWUSA FARM-FRESH PORK (PROCESSED)</h4>
              <div class="rating">
                <span>★★★★★</span>
              </div>
              <p class="price">₦5,000 - ₦10,000</p>
            </div>
          </div>
          <div class="col-4" data-aos="fade-up">
            <a href="productdetailsforprocessedchicken.html" id="processedChickenLink">
              <img src="processed chicken sticker.png" alt="Processed Chicken" />
            </a>
            <div class="product-info">
              <h4>ALAWUSA FARM-FRESH FULL CHICKEN (PROCESSED)</h4>
              <div class="rating">
                <span>★★★★★</span>
              </div>
              <p class="price">₦15,000 - ₦35,000</p>
            </div>
          </div>
          <div class="col-4" data-aos="fade-up">
            <a href="productdetailsforprocessedrayfish.html" id="processedRayfishLink">
              <img src="Processed Rayfish sticker.png" alt="Processed Rayfish" />
            </a>
            <div class="product-info">
              <h4>ALAWUSA SOURCED FRESH RAYFISH</h4>
              <div class="rating">
                <span>★★★★★</span>
              </div>
              <p class="price">₦2,000</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Latest Products -->
    <section class="products-section" style="background: #f9f9f9">
      <div class="small-container">
        <h2 class="title" id="lproducts">Latest Products</h2>
        <div class="row">
          <div class="col-4" data-aos="fade-up">
            <a href="productdetailsforcatfish.html" id="catfishLink">
              <img src="catfish pic.jpeg" alt="Catfish" />
            </a>
            <div class="product-info">
              <h4>ALAWUSA FARM-FRESH CATFISH</h4>
              <div class="rating">
                <span>★★★★★</span>
              </div>
              <p class="price">₦2,000 - ₦4,000</p>
            </div>
          </div>
          <div class="col-4" data-aos="fade-up">
            <a href="productdetailsfordriedcatfish.html" id="driedCatfishLink">
              <img src="Dried catfish sticker.png" alt="Dried Catfish" />
            </a>
            <div class="product-info">
              <h4>ALAWUSA DRIED CAT-FISH (CARTON)</h4>
              <div class="rating">
                <span>★★★★★</span>
              </div>
              <p class="price">₦20,000 - ₦50,000</p>
            </div>
          </div>
          <div class="col-4" data-aos="fade-up">
            <a href="productdetailsfordrysmokedsolefish.html" id="soleFishLink">
              <img src="sole fish sticker.png" alt="Sole Fish" />
            </a>
            <div class="product-info">
              <h4>ALAWUSA SOURCED DRIED SOLE FISH</h4>
              <div class="rating">
                <span>★★★★★</span>
              </div>
              <p class="price">₦5,500 - ₦10,000</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Slideshow Section -->
    <section class="slideshow-section">
      <div class="slideshow-left">
        <div class="fade-slide active">
          <img src="Live chicken sticker.png" alt="Live Chicken" />
        </div>
        <div class="fade-slide">
          <img src="Ray fish sticker.png" alt="Ray Fish" />
        </div>
        <div class="fade-slide">
          <img src="catfish pic.jpeg" alt="Catfish" />
        </div>
        <div class="fade-slide">
          <img src="pig sticker.png" alt="Pig" />
        </div>
        <div class="fade-slide">
          <img src="Chicken Eggs 30 holes sticker.png" alt="Slide 5" />
        </div>
        <div class="fade-slide">
          <img src="Chicken Eggs 15 holes sticker.png" alt="Slide 6" />
        </div>
        <div class="fade-slide">
          <img src="processed chicken sticker.png" alt="Slide 7" />
        </div>
        <div class="fade-slide">
          <img src="Dried catfish sticker.png" alt="Slide 8" />
        </div>
        <div class="fade-slide">
          <img src="Pork sticker.png" alt="Slide 9" />
        </div>
        <div class="fade-slide">
          <img src="sourced seafood sticker.png" alt="Slide 10" />
        </div>
        <div class="fade-slide">
          <img src="sole fish sticker.png" alt="Slide 11" />
        </div>
        <div class="fade-slide">
          <img src="Dry smoked rayfish sticker.png" alt="Slide 12" />
        </div>
        <div class="fade-slide">
          <img src="Processed Rayfish sticker.png" alt="Slide 13" />
        </div>
      </div>
      <div class="slideshow-right">
        <h2>Become our Regular Customer</h2>
        <p>
          Enjoy exclusive discounts and premium services when you shop with us
          regularly.
        </p>
        <a href="products.html" id="shopNowLink" class="btn">
          Shop Now <i class="fas fa-arrow-right"></i>
        </a>
        <a class="btn-sm" href="account.html" id="loyaltyLink">
          Join Loyalty <i class="fas fa-user-check"></i>
        </a>
      </div>
    </section>

    <!-- Agencies Section -->
    <section class="agencies">
      <div class="small-container">
        <h2 class="title">Trusted By</h2>
        <div class="agency-logos">
          <img
            src="federal agency for agriculture 1.png"
            alt="Federal Agency For Agriculture"
          />
          <img src="ogun state logo 1.png" alt="Ogun State" />
          <img src="lagos agency for agriculture 1.png" alt="Lagos State" />
          <img src="panog logo 1.png" alt="PANOG" style="width: 250px" />
        </div>
      </div>
    </section>

    <!-- Newsletter Section -->
    <section class="newsletter-section">
      <div class="container">
        <div class="newsletter-content">
          <div class="newsletter-text">
            <h3>Sign Up For Our Newsletter</h3>
            <p>
              Get email updates about our latest products and special offers
            </p>
          </div>
          <form id="newsletterForm" class="newsletter-form">
            <input
              type="email"
              name="data[email]"
              id="newsletterEmail"
              placeholder="Your email address"
              required
            />
            <button type="submit">Subscribe</button>
          </form>
        </div>
      </div>
    </section>

    <!-- Newsletter Success Popup -->
    <div id="newsletterPopup" class="popup">
      <div class="popup-content">
        <span class="close-btn" id="closeNewsletterPopup">&times;</span>
        <div style="text-align: center; padding: 20px">
          <div style="font-size: 48px; color: #4caf50; margin-bottom: 20px">
            ✓
          </div>
          <h2>Successfully Subscribed!</h2>
          <p>Thank you for subscribing to our newsletter.</p>
          <p>
            You'll receive updates about our latest products and special offers.
          </p>
          <button
            id="closePopupBtn"
            style="
              margin-top: 20px;
              padding: 10px 30px;
              background: #4caf50;
              color: white;
              border: none;
              border-radius: 5px;
              cursor: pointer;
            "
          >
            OK
          </button>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-container">
          <div class="footer-col">
            <a href="index.html"
              ><img
                src="Alawusa heritage logo.png"
                alt="Alawusa Heritage"
                style="width: 200px; filter: brightness(2) invert(0)"
            /></a>
            <p>Bringing the Best of Our Farm to Your Table</p>

            <div class="social-links">
              <a
                href="https://www.facebook.com/profile.php?id=61577588632364&mibextid=ZbWKwL"
                ><img src="facebook.png" alt="Facebook"
              /></a>
              <a
                href="https://www.instagram.com/alawusaheritage?igsh=MXJnbHJ5dGtlOGs0eQ=="
                ><img src="instagram.png" alt="Instagram"
              /></a>
              <a href="https://wa.link/zp8ngg"
                ><img src="whatsapp.png" alt="WhatsApp"
              /></a>
            </div>
          </div>

          <div class="footer-col">
            <h3>Customer Service</h3>
            <ul>
              <li><a href="faq.html" id="faqLink">FAQs</a></li>
              <li><a href="testimonial.html" id="reviewsFooterLink">Reviews</a></li>
              <li><a href="contact.html" id="contactFooterLink">Contact Us</a></li>
            </ul>
          </div>

          <div class="footer-col">
            <h3>Useful Links</h3>
            <ul>
              <li><a href="blogpost.html" id="blogLink">Farm Tips/Blog Post</a></li>
              <li><a href="ourfarm.html" id="farmLink">Our Farm/Sustainability</a></li>
              <li><a href="recipes.html" id="recipesLink">Recipes</a></li>
              <li><a href="aboutus.html" id="aboutFooterLink">About Us</a></li>
              
            </ul>
          </div>

          <div class="footer-col">
            <h3>Contact Info</h3>
            <ul>
              <li><i class="fas fa-phone"></i> +234-802-227-6254</li>
              <li><i class="fas fa-envelope"></i> alawusaheritage@gmail.com</li>
              <li>
                <i class="fas fa-map-marker-alt"></i> Alawusa-House, Hungotho,
                Tube, Ipokia LG, Ogun State
              </li>
            </ul>
          </div>
        </div>

        <div class="copyright">
          <p>&copy; 2025 Alawusa Heritage Fish & Farms. All rights reserved.</p>
        </div>
      </div>
    </footer>

        <!-- Scripts -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
      // Prevent automatic redirection for non-logged in users
      const currentUrl = window.location.href;
      const isIndexPage = currentUrl.includes('index.html') || 
                         currentUrl.endsWith('/') || 
                         currentUrl.includes('dashboard');
      
      // Only allow the index page to be accessed by anyone (logged in or not)
      if (isIndexPage) {
        // Clear any session storage or flags that might trigger redirection
        sessionStorage.removeItem('redirectToLogin');
        localStorage.removeItem('requireLogin');
      }
      
      // Loading Screen Functionality
window.addEventListener("load", function () {
    const loadingScreen = document.getElementById("loadingScreen");
    const loadingProgress = document.getElementById("loadingProgress");

    // Simulate loading progress
    let progress = 0;
    const progressInterval = setInterval(() => {
        progress += Math.random() * 15;
        if (progress > 100) progress = 100;
        loadingProgress.style.width = progress + "%";

        if (progress >= 100) {
            clearInterval(progressInterval);
            setTimeout(() => {
                loadingScreen.classList.add("hidden");
                document.body.style.opacity = "1";
                checkUserStatus();
            }, 200);
        }
    }, 200);
});

      // Initialize AOS
      AOS.init({
        duration: 1000,
        once: true,
      });

      
// Check if user is logged in and if they're an admin
async function checkUserStatus() {
    console.log("Checking user status...");
    
    // Check for specific login indicators
    const loggedInUserId = localStorage.getItem('loggedInUserId');
    const rememberedEmail = localStorage.getItem('rememberedEmail');
    
    console.log("loggedInUserId:", loggedInUserId);
    console.log("rememberedEmail:", rememberedEmail);
    
    // User is logged in if they have a loggedInUserId
    const userIsLoggedIn = loggedInUserId !== null && loggedInUserId !== '';
    
    console.log("Final determination - userIsLoggedIn:", userIsLoggedIn);
    
    if (userIsLoggedIn) {
        try {
            // Import the auth module and check admin status
            const authModule = await import('./firebaseauth.js');
            const userData = await authModule.getUserData();
            
            console.log("User data from Firebase:", userData);
            
            if (userData && userData.isAdmin) {
                console.log("✅ Showing admin interface");
                showAdminUserInterface(userData);
            } else {
                console.log("👤 Showing regular registered user interface");
                showRegisteredUserInterface({
                    id: loggedInUserId,
                    email: rememberedEmail || 'User',
                    name: userData ? userData.name : ''
                });
            }
        } catch (error) {
            console.error("Error checking user status:", error);
            // Fallback to regular user interface
            showRegisteredUserInterface({
                id: loggedInUserId,
                email: rememberedEmail || 'User'
            });
        }
    } else {
        // User is not registered - show non-registered interface
        console.log("Showing non-registered user interface");
        showNonRegisteredUserInterface();
    }
}

// Function to check if user is admin
async function checkIfUserIsAdmin(userId) {
    try {
        // Import Firebase modules
        const { getAuth } = await import('./firebaseauth.js');
        const { getFirestore, doc, getDoc } = await import('https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js');
        
        const auth = getAuth();
        const db = getFirestore();
        
        // Get current user
        const user = auth.currentUser;
        if (!user) return false;
        
        // Get user document from Firestore
        const userDocRef = doc(db, "users", user.uid);
        const userDoc = await getDoc(userDocRef);
        
        if (userDoc.exists()) {
            const userData = userDoc.data();
            return userData.role === "admin" || userData.role === "Admin";
        }
        
        return false;
    } catch (error) {
        console.error("Error checking admin status:", error);
        return false;
    }
}

// Show admin user interface
function showAdminUserInterface(user) {
    console.log("Setting up admin user interface for:", user);
    
    // Try to get the actual username from localStorage
    const storedUserName = localStorage.getItem('userName3');
    const storedUserEmail = localStorage.getItem('userEmail');
    
    console.log("Stored username from localStorage:", storedUserName);
    console.log("Stored email from localStorage:", storedUserEmail);
    
    // Use the actual username if available, otherwise use email prefix
    let userDisplayName = 'Admin';
    if (storedUserName && storedUserName.trim() !== '') {
        userDisplayName = storedUserName + " (Admin)";
    } else if (user.email) {
        userDisplayName = user.email.split('@')[0] + " (Admin)";
    }
    
    console.log("Admin display name:", userDisplayName);
    
    // Update the UI with the admin username
    document.getElementById('userName').textContent = userDisplayName;
    document.getElementById('userName2').textContent = userDisplayName;
    
    // Show registered user sections
    document.getElementById('registeredUserSection').classList.remove('hidden');
    document.getElementById('registeredUserSectionMobile').classList.remove('hidden');
    
    // Hide the regular Account link 
    const profileLink = document.getElementById('profileLink');
    const profileLinkMobile = document.getElementById('profileLinkMobile');
    if (profileLink) profileLink.classList.add('hidden');
    if (profileLinkMobile) profileLinkMobile.classList.add('hidden');
    
    // ADD ADMIN DASHBOARD LINK TO DESKTOP MENU
    const desktopNavUl = document.querySelector('.desktop-nav ul');
    
    // Check if admin link already exists
    let adminLinkExists = false;
    document.querySelectorAll('.desktop-nav ul li a').forEach(link => {
        if (link.textContent.includes('Admin Dashboard') || link.href.includes('admin-dashboard')) {
            adminLinkExists = true;
        }
    });
    
    // Add admin dashboard link if it doesn't exist
    if (!adminLinkExists) {
        // Create admin dashboard menu item
        const adminLi = document.createElement('li');
        const adminLink = document.createElement('a');
        adminLink.href = 'admin-dashboard.html';
        adminLink.innerHTML = 'Admin Dashboard';
        
        adminLink.style.fontWeight = 'bold';
        
        adminLi.appendChild(adminLink);
        
        // Insert after the registered user section
        const registeredUserSection = document.getElementById('registeredUserSection');
        if (registeredUserSection) {
            registeredUserSection.parentNode.insertBefore(adminLi, registeredUserSection.nextSibling);
        }
    }
    
    // ADD ADMIN DASHBOARD LINK TO MOBILE MENU
    const mobileMenuUl = document.querySelector('#mobileMenu ul');
    
    // Check if admin link already exists in mobile menu
    let mobileAdminLinkExists = false;
    document.querySelectorAll('#mobileMenu ul li a').forEach(link => {
        if (link.textContent.includes('Admin Dashboard') || link.href.includes('admin-dashboard')) {
            mobileAdminLinkExists = true;
        }
    });
    
    // Add admin dashboard link to mobile menu if it doesn't exist
    if (!mobileAdminLinkExists) {
        // Create admin dashboard menu item for mobile
        const mobileAdminLi = document.createElement('li');
        const mobileAdminLink = document.createElement('a');
        mobileAdminLink.href = 'admin-dashboard.html';
        mobileAdminLink.innerHTML = 'Admin Dashboard';
        
        mobileAdminLink.style.fontWeight = 'bold';
        
        mobileAdminLi.appendChild(mobileAdminLink);
        
        // Insert after the registered user section in mobile menu
        const registeredUserSectionMobile = document.getElementById('registeredUserSectionMobile');
        if (registeredUserSectionMobile) {
            registeredUserSectionMobile.parentNode.insertBefore(mobileAdminLi, registeredUserSectionMobile.nextSibling);
        }
    }
    
    // Also add admin dashboard link to user dropdown
    const userDropdown = document.getElementById('userDropdown');
    const userDropdownMobile = document.getElementById('userDropdownMobile');
    
    // Create admin dashboard link for dropdown
    const adminDropdownLink = document.createElement('a');
    adminDropdownLink.href = 'admin-dashboard.html';
    adminDropdownLink.innerHTML = '<i class="fas fa-tachometer-alt"></i> Admin Dashboard';
    
    adminDropdownLink.style.fontWeight = 'bold';
    
    // Add to both dropdowns
    if (userDropdown) {
        // Insert at the top of dropdown
        userDropdown.insertBefore(adminDropdownLink.cloneNode(true), userDropdown.firstChild);
    }
    
    if (userDropdownMobile) {
        // Insert at the top of mobile dropdown
        userDropdownMobile.insertBefore(adminDropdownLink.cloneNode(true), userDropdownMobile.firstChild);
    }
    
    // Update links for registered users (same as regular users)
    updateLink('productsLink', 'userproducts.html');
    updateLink('productsLinkMobile', 'userproducts.html');
    updateLink('aboutLink', 'useraboutus.html');
    updateLink('aboutLinkMobile', 'useraboutus.html');
    updateLink('contactLink', 'usercontact.html');
    updateLink('contactLinkMobile', 'usercontact.html');
    updateLink('cartLink', 'usercart.html');
    updateLink('reviewsLinkMobile', 'usertestimonial.html');
    
    // Update product links
    const productLinks = [
        'liveChickenLink', 'rayfishLink', 'livePigsLink', 'porkLink',
        'processedChickenLink', 'processedRayfishLink', 'catfishLink',
        'driedCatfishLink', 'soleFishLink'
    ];
    
    productLinks.forEach(linkId => {
        const link = document.getElementById(linkId);
        if (link) {
            const currentHref = link.getAttribute('href');
            if (currentHref) {
                if (currentHref.includes('productdetailsfor')) {
                    link.href = 'userproducts.html';
                }
            }
        }
    });
    
    // Update footer links
    updateLink('faqLink', 'userfaq.html');
    updateLink('contactFooterLink', 'usercontact.html');
    updateLink('blogLink', 'userblogpost.html');
    updateLink('farmLink', 'userourfarm.html');
    updateLink('recipesLink', 'userrecipes.html');
    updateLink('aboutFooterLink', 'useraboutus.html');
    updateLink('reviewsFooterLink', 'usertestimonial.html');
    
    // Update shop now link
    updateLink('shopNowLink', 'userproducts.html');
    
    // Hide loyalty link and signup popup
    const loyaltyLink = document.getElementById('loyaltyLink');
    if (loyaltyLink) loyaltyLink.classList.add('hidden');
    
    const popup = document.getElementById('popup');
    if (popup) {
        popup.classList.remove('active');
    }
    
    console.log("Admin user interface setup complete");
}

      
            
            // Show registered user interface
      function showRegisteredUserInterface(user) {
        console.log("Setting up registered user interface for:", user);
        
        // Try to get the actual username from localStorage (set by homepage.js)
        const storedUserName = localStorage.getItem('userName3');
        const storedUserEmail = localStorage.getItem('userEmail');
        
        console.log("Stored username from localStorage:", storedUserName);
        console.log("Stored email from localStorage:", storedUserEmail);
        
        // Use the actual username if available, otherwise use email prefix
        let userDisplayName = 'Customer';
        if (storedUserName && storedUserName.trim() !== '') {
          userDisplayName = storedUserName;
        } else if (user.email) {
          userDisplayName = user.email.split('@')[0];
        }
        
        console.log("Final display name:", userDisplayName);
        
        // Update the UI with the actual username
        document.getElementById('userName').textContent = userDisplayName;
        document.getElementById('userName2').textContent = userDisplayName;
        
        // Show registered user sections
        document.getElementById('registeredUserSection').classList.remove('hidden');
        document.getElementById('registeredUserSectionMobile').classList.remove('hidden');
        
        // Hide the regular Account link (since we have dropdown)
        const profileLink = document.getElementById('profileLink');
        const profileLinkMobile = document.getElementById('profileLinkMobile');
        if (profileLink) profileLink.classList.add('hidden');
        if (profileLinkMobile) profileLinkMobile.classList.add('hidden');
        
        // Update links for registered users
        updateLink('productsLink', 'userproducts.html');
        updateLink('productsLinkMobile', 'userproducts.html');
        updateLink('aboutLink', 'useraboutus.html');
        updateLink('aboutLinkMobile', 'useraboutus.html');
        updateLink('contactLink', 'usercontact.html');
        updateLink('contactLinkMobile', 'usercontact.html');
        updateLink('cartLink', 'usercart.html');
        updateLink('reviewsLinkMobile', 'usertestimonial.html');
        
        // Update product links for registered users
        const productLinks = [
          'liveChickenLink', 'rayfishLink', 'livePigsLink', 'porkLink',
          'processedChickenLink', 'processedRayfishLink', 'catfishLink',
          'driedCatfishLink', 'soleFishLink'
        ];
        
        productLinks.forEach(linkId => {
          const link = document.getElementById(linkId);
          if (link) {
            const currentHref = link.getAttribute('href');
            if (currentHref) {
              // For product detail pages, redirect to main products page
              if (currentHref.includes('productdetailsfor')) {
                link.href = 'userproducts.html';
              }
            }
          }
        });
        
        // Update footer links for registered users
        updateLink('faqLink', 'userfaq.html');
        updateLink('contactFooterLink', 'usercontact.html');
        updateLink('blogLink', 'userblogpost.html');
        updateLink('farmLink', 'userourfarm.html');
        updateLink('recipesLink', 'userrecipes.html');
        updateLink('aboutFooterLink', 'useraboutus.html');
        updateLink('reviewsFooterLink', 'usertestimonial.html');
        
        // Update shop now link
        updateLink('shopNowLink', 'userproducts.html');
        
        // Hide loyalty link and signup popup for registered users
        const loyaltyLink = document.getElementById('loyaltyLink');
        if (loyaltyLink) loyaltyLink.classList.add('hidden');
        
        const popup = document.getElementById('popup');
        if (popup) {
          popup.classList.remove('active');
        }
        
        console.log("Registered user interface setup complete");
      }

      // Helper function to update links
      function updateLink(elementId, newHref) {
        const element = document.getElementById(elementId);
        if (element && element.tagName === 'A') {
          element.href = newHref;
        }
      }

      // Show non-registered user interface
      function showNonRegisteredUserInterface() {
        console.log("Setting up non-registered user interface");
        
        // Hide registered user sections
        document.getElementById('registeredUserSection').classList.add('hidden');
        document.getElementById('registeredUserSectionMobile').classList.add('hidden');
        
        // Show the regular Account link
        const profileLink = document.getElementById('profileLink');
        const profileLinkMobile = document.getElementById('profileLinkMobile');
        if (profileLink) profileLink.classList.remove('hidden');
        if (profileLinkMobile) profileLinkMobile.classList.remove('hidden');
        
        document.getElementById('notificationsBell').classList.add('hidden');

        // Show signup popup after delay
        setTimeout(() => {
          const popup = document.getElementById('popup');
          if (popup) {
            popup.classList.add('active');
          }
        }, 1000);
        
        // Show loyalty link
        const loyaltyLink = document.getElementById('loyaltyLink');
        if (loyaltyLink) loyaltyLink.classList.remove('hidden');
        
        console.log("Non-registered user interface setup complete");
      }

      // Mobile Menu Functions
      function openMenu() {
        document.getElementById("mobileMenu").classList.add("open");
      }

      function closeMenu() {
        document.getElementById("mobileMenu").classList.remove("open");
      }

      // Slideshow Functionality
      const slides = document.querySelectorAll(".fade-slide");
      let currentSlide = 0;

      function showSlide(index) {
        slides.forEach((slide, i) => {
          slide.classList.remove("active");
        });
        slides[index].classList.add("active");
      }

      function nextSlide() {
        currentSlide = (currentSlide + 1) % slides.length;
        showSlide(currentSlide);
      }

      // Start slideshow
      setInterval(nextSlide, 4000);

      // Popup Functionality
      const popup = document.getElementById("popup");
      const closePopupBtn = document.getElementById("closePopup");
      const registerBtn = document.getElementById("registerBtn");

      // Close popup
      if (closePopupBtn) {
        closePopupBtn.addEventListener("click", () => {
          if (popup) popup.classList.remove("active");
        });
      }

      // Redirect to account page
      if (registerBtn) {
        registerBtn.addEventListener("click", () => {
          window.location.href = "account.html";
        });
      }

      // Close mobile menu when clicking on links
      document.querySelectorAll("#mobileMenu a").forEach((link) => {
        link.addEventListener("click", closeMenu);
      });

      // User Dropdown Functionality
      const userDropdownToggle = document.getElementById("userDropdownToggle");
      const userDropdown = document.getElementById("userDropdown");

      function toggleUserDropdown() {
        if (userDropdown) userDropdown.classList.toggle("active");
      }

      if (userDropdownToggle) {
        userDropdownToggle.addEventListener("click", function (e) {
          e.stopPropagation();
          toggleUserDropdown();
        });
      }

      // Close dropdown when clicking outside
      document.addEventListener("click", function (e) {
        if (userDropdown && userDropdownToggle) {
          if (
            !userDropdown.contains(e.target) &&
            !userDropdownToggle.contains(e.target)
          ) {
            userDropdown.classList.remove("active");
          }
        }
      });

      // Mobile User Dropdown Functionality
      const userDropdownToggleMobile = document.getElementById("userDropdownToggleMobile");
      const userDropdownMobile = document.getElementById("userDropdownMobile");

      function toggleUserDropdownMobile() {
        if (userDropdownMobile) userDropdownMobile.classList.toggle("active");
      }

      if (userDropdownToggleMobile) {
        userDropdownToggleMobile.addEventListener("click", function (e) {
          e.stopPropagation();
          toggleUserDropdownMobile();
        });
      }

      // Close mobile dropdown when clicking outside
      document.addEventListener("click", function (e) {
        if (userDropdownMobile && userDropdownToggleMobile) {
          if (
            !userDropdownMobile.contains(e.target) &&
            !userDropdownToggleMobile.contains(e.target)
          ) {
            userDropdownMobile.classList.remove("active");
          }
        }
      });

      // Cart functionality
      function updateCartCount() {
        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        const cartCount = document.getElementById("cart-count");
        if (cartCount) {
          cartCount.textContent = totalItems;
        }
      }

      // Initialize cart count
      updateCartCount();

      
            // Logout functionality
      const logoutButtons = document.querySelectorAll('#logoutButton, #logoutButtonOne');
      logoutButtons.forEach(button => {
        if (button) {
          button.addEventListener('click', function(e) {
            e.preventDefault();
            // Clear ALL login data
            localStorage.removeItem('loggedInUserId');
            localStorage.removeItem('rememberedEmail');
            localStorage.removeItem('rememberedPassword');
            localStorage.removeItem('preferences_' + loggedInUserId); 
            // Also clear other possible keys
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('currentUser');
            localStorage.removeItem('userLoggedIn');
            localStorage.removeItem('loggedInUser');
            localStorage.removeItem('user');
            // Redirect to index
            window.location.href = 'index.html';
          });
        }
      });

      // Newsletter form submission
      const newsletterForm = document.getElementById("newsletterForm");
      if (newsletterForm) {
        newsletterForm.addEventListener("submit", async function (e) {
          e.preventDefault();

          const emailInput = document.getElementById("newsletterEmail");
          const email = emailInput.value;
          const submitBtn = this.querySelector('button[type="submit"]');

          // Validate email
          if (!email || !email.includes("@")) {
            alert("Please enter a valid email address");
            return;
          }

          // Disable button to prevent multiple submissions
          const originalBtnText = submitBtn.textContent;
          submitBtn.textContent = "Subscribing...";
          submitBtn.disabled = true;

          try {
            // Prepare form data for SheetDB
            const formData = new FormData();
            formData.append("data[email]", email);
            formData.append(
              "data[date]",
              new Date().toISOString().split("T")[0]
            );

            // Send to SheetDB
            const response = await fetch(
              "https://sheetdb.io/api/v1/7pjxxvpo241l5",
              {
                method: "POST",
                body: formData,
              }
            );

            if (response.ok) {
              // Show success popup
              const popup = document.getElementById("newsletterPopup");
              popup.classList.add("active");

              // Reset form
              this.reset();

              // Store in localStorage to track subscriptions
              const subscribers = JSON.parse(
                localStorage.getItem("newsletterSubscribers") || "[]"
              );
              subscribers.push({
                email: email,
                date: new Date().toISOString(),
              });
              localStorage.setItem(
                "newsletterSubscribers",
                JSON.stringify(subscribers)
              );
            } else {
              throw new Error("Subscription failed");
            }
          } catch (error) {
            console.error("Subscription Error:", error);
            alert("❌ Failed to subscribe. Please try again.");
          } finally {
            // Re-enable button
            submitBtn.textContent = originalBtnText;
            submitBtn.disabled = false;
          }
        });
      }

      // Close newsletter popup
      function closeNewsletterPopup() {
        const popup = document.getElementById("newsletterPopup");
        if (popup) popup.classList.remove("active");
      }

      // Event listeners for popup close buttons
      const closeNewsletterPopupBtn = document.getElementById("closeNewsletterPopup");
      const closePopupBtn2 = document.getElementById("closePopupBtn");
      
      if (closeNewsletterPopupBtn) {
        closeNewsletterPopupBtn.addEventListener("click", closeNewsletterPopup);
      }
      
      if (closePopupBtn2) {
        closePopupBtn2.addEventListener("click", closeNewsletterPopup);
      }

      // Close popup when clicking outside
      const newsletterPopup = document.getElementById("newsletterPopup");
      if (newsletterPopup) {
        newsletterPopup.addEventListener("click", function (e) {
          if (e.target === this) {
            closeNewsletterPopup();
          }
        });
      }

      // Close popup with Escape key
      document.addEventListener("keydown", function (e) {
        if (e.key === "Escape") {
          closeNewsletterPopup();
          const popup = document.getElementById("popup");
          if (popup) popup.classList.remove("active");
        }
      });

      // Chatbase script
      (function () {
        if (!window.chatbase || window.chatbase("getState") !== "initialized") {
          window.chatbase = (...arguments) => {
            if (!window.chatbase.q) {
              window.chatbase.q = [];
            }
            window.chatbase.q.push(arguments);
          };
          window.chatbase = new Proxy(window.chatbase, {
            get(target, prop) {
              if (prop === "q") {
                return target.q;
              }
              return (...args) => target(prop, ...args);
            },
          });
        }
        const onLoad = function () {
          const script = document.createElement("script");
          script.src = "https://www.chatbase.co/embed.min.js";
          script.id = "TcwUb0cLFLQZZlxVHISps";
          script.domain = "www.chatbase.co";
          document.body.appendChild(script);
        };
        if (document.readyState === "complete") {
          onLoad();
        } else {
          window.addEventListener("load", onLoad);
        }

      })();

      // ========== NOTIFICATION SYSTEM ==========

// Import Firebase modules for notifications
let notificationsUnsubscribe = null;
let notificationPermission = false;
let allNotifications = [];

// Request browser notification permission
async function requestNotificationPermission() {
    if (!("Notification" in window)) {
        console.log("This browser does not support notifications");
        return false;
    }

    if (Notification.permission === "granted") {
        return true;
    } else if (Notification.permission !== "denied") {
        const permission = await Notification.requestPermission();
        return permission === "granted";
    }
    return false;
}

// Show browser notification
function showBrowserNotification(title, options) {
    if (!("Notification" in window)) {
        console.log("This browser does not support notifications");
        return;
    }

    if (Notification.permission === "granted") {
        const notification = new Notification(title, options);
        
        // Close notification after 5 seconds
        setTimeout(() => {
            notification.close();
        }, 5000);

        // Handle click on notification
        notification.onclick = function() {
            window.focus();
            notification.close();
            // Navigate to orders page if it's an order notification
            if (options.data && options.data.orderId) {
                const userIsLoggedIn = localStorage.getItem('loggedInUserId') !== null;
                if (userIsLoggedIn) {
                    window.location.href = 'userorders.html';
                }
            }
        };
    }
}

// Get time ago format
function getTimeAgo(timestamp) {
    if (!timestamp) return 'Just now';
    
    let date;
    if (timestamp.toDate) {
        // It's a Firestore timestamp
        date = timestamp.toDate();
    } else if (timestamp instanceof Date) {
        date = timestamp;
    } else if (typeof timestamp === 'string') {
        date = new Date(timestamp);
    } else {
        date = new Date(timestamp);
    }
    
    if (isNaN(date.getTime())) {
        return 'Just now';
    }
    
    const now = new Date();
    const seconds = Math.floor((now - date) / 1000);
    
    if (seconds < 0) return 'Just now';
    if (seconds < 60) return 'Just now';
    
    const minutes = Math.floor(seconds / 60);
    if (minutes < 60) {
        return `${minutes} minute${minutes === 1 ? '' : 's'} ago`;
    }
    
    const hours = Math.floor(minutes / 60);
    if (hours < 24) {
        return `${hours} hour${hours === 1 ? '' : 's'} ago`;
    }
    
    const days = Math.floor(hours / 24);
    if (days < 30) {
        return `${days} day${days === 1 ? '' : 's'} ago`;
    }
    
    const months = Math.floor(days / 30);
    if (months < 12) {
        return `${months} month${months === 1 ? '' : 's'} ago`;
    }
    
    const years = Math.floor(months / 12);
    return `${years} year${years === 1 ? '' : 's'} ago`;
}

// Show in-page notification
function showInPageNotification(notification) {
    const userIsLoggedIn = localStorage.getItem('loggedInUserId') !== null;
    if (!userIsLoggedIn) return; // Only show notifications to logged in users
    
    // Create notification element
    const notificationEl = document.createElement('div');
    notificationEl.className = 'in-page-notification';
    notificationEl.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: var(--primary-color);
        color: white;
        padding: 15px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        z-index: 9999;
        max-width: 350px;
        animation: slideIn 0.3s ease;
        cursor: pointer;
        transition: transform 0.3s ease;
    `;
    
    notificationEl.innerHTML = `
        <div style="display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-shipping-fast" style="font-size: 20px;"></i>
            <div>
                <strong style="display: block; margin-bottom: 5px;">Order Update</strong>
                <span style="font-size: 14px;">${notification.message}</span>
            </div>
            <button onclick="this.parentElement.parentElement.remove()" 
                    style="background: none; border: none; color: white; cursor: pointer; margin-left: auto;">
                <i class="fas fa-times"></i>
            </button>
        </div>
    `;
    
    // Add click handler to go to orders
    notificationEl.onclick = function() {
        if (notification.orderId) {
            // Mark as read when clicked
            markNotificationAsRead(notification.id);
            const userIsLoggedIn = localStorage.getItem('loggedInUserId') !== null;
            if (userIsLoggedIn) {
                window.location.href = 'userorders.html';
            }
        }
        this.remove();
    };
    
    // Add to body
    document.body.appendChild(notificationEl);
    
    // Auto-remove after 10 seconds
    setTimeout(() => {
        if (notificationEl.parentNode) {
            notificationEl.style.animation = 'slideOut 0.3s ease';
            setTimeout(() => {
                if (notificationEl.parentNode) {
                    notificationEl.remove();
                }
            }, 300);
        }
    }, 10000);
}

// Handle new real-time notification
function handleNewNotification(notification) {
    // Show in-page notification
    showInPageNotification(notification);
    
    // Show browser notification if permission granted
    if (notificationPermission) {
        showBrowserNotification(notification.message, {
            body: 'Click to view details',
            icon: 'Alawusa heritage icon - Icon.png',
            badge: 'Alawusa heritage icon - Icon.png',
            tag: 'alawusa-order-notification',
            requireInteraction: false,
            data: {
                orderId: notification.orderId,
                type: notification.type
            }
        });
    }
    
    // Update notification count
    updateNotificationCount();
    
    // Refresh notifications list to show updated time
    const notificationsDropdown = document.getElementById('notificationsDropdown');
    if (notificationsDropdown && notificationsDropdown.classList.contains('active')) {
        loadNotifications();
    }
}

// Setup notifications listener for real-time updates
async function setupNotificationsListener(userId) {
    if (!userId) return;
    
    // Clean up previous listener
    if (notificationsUnsubscribe) {
        notificationsUnsubscribe();
    }

    try {
        // Dynamically import Firebase modules
        const { initializeApp } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js");
        const { getFirestore, collection, query, where, orderBy, limit, onSnapshot } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js");

        // Initialize Firebase if not already initialized
        const firebaseConfig = {
            apiKey: "AIzaSyDuxTHLfwiETTMO6Dx7YMehngZqWLgUlH0",
            authDomain: "alawusa-heritage-website.firebaseapp.com",
            projectId: "alawusa-heritage-website",
            storageBucket: "alawusa-heritage-website.firebasestorage.app",
            messagingSenderId: "857988164081",
            appId: "1:857988164081:web:ccac1200d344a8bd82bc50",
            measurementId: "G-TJQJMVVMZG"
        };

        // Initialize app
        const app = initializeApp(firebaseConfig, 'notifications-app');
        const db = getFirestore(app);

        // Listen for new notifications (real-time only)
        const notificationsQuery = query(
            collection(db, 'notifications'),
            where('userId', '==', userId),
            orderBy('createdAt', 'desc'),
            limit(5)
        );

        notificationsUnsubscribe = onSnapshot(notificationsQuery, (snapshot) => {
            snapshot.docChanges().forEach(change => {
                if (change.type === 'added') {
                    const notification = change.doc.data();
                    notification.id = change.doc.id;
                    
                    // Only show notification if it's new (created in the last 5 seconds)
                    const notificationTime = notification.createdAt?.toDate() || new Date();
                    const timeDiff = new Date() - notificationTime;
                    
                    if (timeDiff < 5000) { // Show if less than 5 seconds old
                        handleNewNotification(notification);
                    }
                }
            });
        }, (error) => {
            console.error('Error in notifications listener:', error);
        });
    } catch (error) {
        console.error('Error setting up notifications listener:', error);
    }
}

// Load notifications for dropdown
async function loadNotifications() {
    const userIsLoggedIn = localStorage.getItem('loggedInUserId') !== null;
    if (!userIsLoggedIn) {
        // Show login prompt in notifications
        const notificationsList = document.getElementById('notificationsList');
        if (notificationsList) {
            notificationsList.innerHTML = `
                <div class="notification-item">
                    <div class="notification-message">Please login to see notifications</div>
                    <div class="notification-time"><a href="account.html" style="color: var(--primary-color);">Login Now</a></div>
                </div>
            `;
        }
        return;
    }

    const userId = localStorage.getItem('loggedInUserId');
    if (!userId) return;

    try {
        // Dynamically import Firebase modules
        const { initializeApp } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js");
        const { getFirestore, collection, query, where, orderBy, limit, getDocs } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js");

        const firebaseConfig = {
            apiKey: "AIzaSyDuxTHLfwiETTMO6Dx7YMehngZqWLgUlH0",
            authDomain: "alawusa-heritage-website.firebaseapp.com",
            projectId: "alawusa-heritage-website",
            storageBucket: "alawusa-heritage-website.firebasestorage.app",
            messagingSenderId: "857988164081",
            appId: "1:857988164081:web:ccac1200d344a8bd82bc50",
            measurementId: "G-TJQJMVVMZG"
        };

        const app = initializeApp(firebaseConfig, 'notifications-load-app');
        const db = getFirestore(app);

        const q = query(
            collection(db, 'notifications'),
            where('userId', '==', userId),
            orderBy('createdAt', 'desc'),
            limit(20)
        );
        
        const querySnapshot = await getDocs(q);
        allNotifications = [];
        let notificationsHTML = '';

        querySnapshot.forEach((doc) => {
            const notification = doc.data();
            notification.id = doc.id;
            allNotifications.push(notification);

            const timeAgo = getTimeAgo(notification.createdAt?.toDate());
            
            notificationsHTML += `
                <div class="notification-item ${notification.read ? '' : 'unread'}" 
                     data-id="${doc.id}" 
                     onclick="viewNotification('${doc.id}')">
                    <div class="notification-message">${notification.message}</div>
                    <div class="notification-time">${timeAgo}</div>
                    ${!notification.read ? '<span class="unread-badge">NEW</span>' : ''}
                </div>
            `;
        });

        const notificationsList = document.getElementById('notificationsList');
        if (notificationsList) {
            notificationsList.innerHTML = notificationsHTML || `
                <div class="notification-item">
                    <div class="notification-message">No notifications yet</div>
                    <div class="notification-time">Today</div>
                </div>
            `;
        }
    } catch (error) {
        console.error('Error loading notifications:', error);
        const notificationsList = document.getElementById('notificationsList');
        if (notificationsList) {
            notificationsList.innerHTML = `
                <div class="notification-item">
                    <div class="notification-message">Error loading notifications</div>
                    <div class="notification-time">Please try again later</div>
                </div>
            `;
        }
    }
}

// Update notification count
async function updateNotificationCount() {
    const userIsLoggedIn = localStorage.getItem('loggedInUserId') !== null;
    if (!userIsLoggedIn) {
        const notificationCount = document.getElementById('notificationCount');
        const notificationCountMobile = document.getElementById('notificationCountMobile');
        if (notificationCount) notificationCount.textContent = '0';
        if (notificationCountMobile) notificationCountMobile.textContent = '0';
        return;
    }

    const userId = localStorage.getItem('loggedInUserId');
    if (!userId) return;

    try {
        const { initializeApp } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js");
        const { getFirestore, collection, query, where, getDocs } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js");

        const firebaseConfig = {
            apiKey: "AIzaSyDuxTHLfwiETTMO6Dx7YMehngZqWLgUlH0",
            authDomain: "alawusa-heritage-website.firebaseapp.com",
            projectId: "alawusa-heritage-website",
            storageBucket: "alawusa-heritage-website.firebasestorage.app",
            messagingSenderId: "857988164081",
            appId: "1:857988164081:web:ccac1200d344a8bd82bc50",
            measurementId: "G-TJQJMVVMZG"
        };

        const app = initializeApp(firebaseConfig, 'notification-count-app');
        const db = getFirestore(app);

        const q = query(
            collection(db, 'notifications'),
            where('userId', '==', userId)
        );
        
        const querySnapshot = await getDocs(q);
        let unreadCount = 0;
        
        querySnapshot.forEach((doc) => {
            const notification = doc.data();
            if (!notification.read) {
                unreadCount++;
            }
        });
        
        const notificationCount = document.getElementById('notificationCount');
        const notificationCountMobile = document.getElementById('notificationCountMobile');
        const notificationsBell = document.getElementById('notificationsBell');
        
        if (notificationCount) notificationCount.textContent = unreadCount;
        if (notificationCountMobile) notificationCountMobile.textContent = unreadCount;
        
        if (notificationsBell) {
            if (unreadCount > 0) {
                notificationsBell.classList.add('has-notifications');
            } else {
                notificationsBell.classList.remove('has-notifications');
            }
        }
    } catch (error) {
        console.error('Error updating notification count:', error);
        const notificationCount = document.getElementById('notificationCount');
        const notificationCountMobile = document.getElementById('notificationCountMobile');
        if (notificationCount) notificationCount.textContent = '0';
        if (notificationCountMobile) notificationCountMobile.textContent = '0';
    }
}

// Mark notification as read
async function markNotificationAsRead(notificationId) {
    const userIsLoggedIn = localStorage.getItem('loggedInUserId') !== null;
    if (!userIsLoggedIn) return;

    const userId = localStorage.getItem('loggedInUserId');
    if (!userId) return;

    try {
        const { initializeApp } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js");
        const { getFirestore, doc, updateDoc } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js");

        const firebaseConfig = {
            apiKey: "AIzaSyDuxTHLfwiETTMO6Dx7YMehngZqWLgUlH0",
            authDomain: "alawusa-heritage-website.firebaseapp.com",
            projectId: "alawusa-heritage-website",
            storageBucket: "alawusa-heritage-website.firebasestorage.app",
            messagingSenderId: "857988164081",
            appId: "1:857988164081:web:ccac1200d344a8bd82bc50",
            measurementId: "G-TJQJMVVMZG"
        };

        const app = initializeApp(firebaseConfig, 'mark-read-app');
        const db = getFirestore(app);

        const notificationRef = doc(db, 'notifications', notificationId);
        await updateDoc(notificationRef, { read: true });
        
        // Update count after marking as read
        updateNotificationCount();
    } catch (error) {
        console.error('Error marking notification as read:', error);
    }
}

// View notification
async function viewNotification(notificationId) {
    const userIsLoggedIn = localStorage.getItem('loggedInUserId') !== null;
    if (!userIsLoggedIn) {
        window.location.href = 'account.html';
        return;
    }

    try {
        // Mark as read when viewed
        await markNotificationAsRead(notificationId);
        
        // Navigate to orders page
        window.location.href = 'userorders.html';
    } catch (error) {
        console.error('Error viewing notification:', error);
    }
}

// Setup notifications dropdown
function setupNotificationsDropdown() {
    const notificationsBell = document.getElementById('notificationsBell');
    const notificationsDropdown = document.getElementById('notificationsDropdown');
    const markAllReadBtn = document.getElementById('markAllRead');
    const viewAllNotifications = document.getElementById('viewAllNotifications');
    
    if (!notificationsBell || !notificationsDropdown) return;

    // Toggle dropdown
    notificationsBell.addEventListener('click', function(e) {
        e.stopPropagation();
        const userIsLoggedIn = localStorage.getItem('loggedInUserId') !== null;
        
        if (!userIsLoggedIn) {
            window.location.href = 'account.html';
            return;
        }
        
        notificationsDropdown.classList.toggle('active');
        
        // Refresh notifications when dropdown opens
        if (notificationsDropdown.classList.contains('active')) {
            loadNotifications();
        }
    });

    // Close dropdown when clicking outside
    document.addEventListener('click', function(e) {
        if (notificationsDropdown && !notificationsDropdown.contains(e.target) && 
            notificationsBell && !notificationsBell.contains(e.target)) {
            notificationsDropdown.classList.remove('active');
        }
    });

    // Mark all as read
    if (markAllReadBtn) {
        markAllReadBtn.addEventListener('click', async function() {
            const userIsLoggedIn = localStorage.getItem('loggedInUserId') !== null;
            if (!userIsLoggedIn) {
                alert('Please login to mark notifications as read');
                window.location.href = 'account.html';
                return;
            }

            const userId = localStorage.getItem('loggedInUserId');
            if (!userId) return;

            try {
                const { initializeApp } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js");
                const { getFirestore, collection, query, where, getDocs, updateDoc, doc } = await import("https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js");

                const firebaseConfig = {
                    apiKey: "AIzaSyDuxTHLfwiETTMO6Dx7YMehngZqWLgUlH0",
                    authDomain: "alawusa-heritage-website.firebaseapp.com",
                    projectId: "alawusa-heritage-website",
                    storageBucket: "alawusa-heritage-website.firebasestorage.app",
                    messagingSenderId: "857988164081",
                    appId: "1:857988164081:web:ccac1200d344a8bd82bc50",
                    measurementId: "G-TJQJMVVMZG"
                };

                const app = initializeApp(firebaseConfig, 'mark-all-read-app');
                const db = getFirestore(app);

                const q = query(
                    collection(db, 'notifications'),
                    where('userId', '==', userId),
                    where('read', '==', false)
                );
                
                const snapshot = await getDocs(q);
                const promises = [];
                
                snapshot.forEach((doc) => {
                    promises.push(updateDoc(doc.ref, { read: true }));
                });

                await Promise.all(promises);
                
                // Update count and refresh
                updateNotificationCount();
                loadNotifications();
                
                // Show success message
                const successMsg = document.createElement('div');
                successMsg.style.cssText = `
                    background: #d4edda;
                    color: #155724;
                    padding: 10px;
                    margin: 10px;
                    border-radius: 4px;
                    text-align: center;
                `;
                successMsg.textContent = 'All notifications marked as read';
                const notificationsList = document.getElementById('notificationsList');
                if (notificationsList) {
                    notificationsList.prepend(successMsg);
                }
                
                setTimeout(() => successMsg.remove(), 3000);
            } catch (error) {
                console.error('Error marking notifications as read:', error);
                alert('Error marking notifications as read. Please try again.');
            }
        });
    }

    // Update "View All" link based on login status
    if (viewAllNotifications) {
        viewAllNotifications.addEventListener('click', function(e) {
            const userIsLoggedIn = localStorage.getItem('loggedInUserId') !== null;
            if (!userIsLoggedIn) {
                e.preventDefault();
                window.location.href = 'account.html';
            }
        });
    }
}

// Initialize notifications for registered users
async function initializeNotificationsForUser(user) {
    if (!user || !user.id) return;
    
    // Request notification permission
    notificationPermission = await requestNotificationPermission();
    
    // First, load initial notification count
    await updateNotificationCount();
    
    // Then setup real-time listener
    await setupNotificationsListener(user.id);
    
    // Setup notifications dropdown
    setupNotificationsDropdown();
}

// Update checkUserStatus function to initialize notifications
async function checkUserStatus() {
    console.log("Checking user status...");
    
    const loggedInUserId = localStorage.getItem('loggedInUserId');
    const rememberedEmail = localStorage.getItem('rememberedEmail');
    const userIsLoggedIn = loggedInUserId !== null && loggedInUserId !== '';
    
    console.log("Final determination - userIsLoggedIn:", userIsLoggedIn);
    
    if (userIsLoggedIn) {
        try {
            // Import the auth module and check admin status
            const authModule = await import('./firebaseauth.js');
            const userData = await authModule.getUserData();
            
            console.log("User data from Firebase:", userData);
            
            if (userData && userData.isAdmin) {
                console.log("✅ Showing admin interface");
                showAdminUserInterface(userData);
                // Initialize notifications for admin
                initializeNotificationsForUser({
                    id: loggedInUserId,
                    email: rememberedEmail || 'User',
                    name: userData ? userData.name : ''
                });
            } else {
                console.log("👤 Showing regular registered user interface");
                showRegisteredUserInterface({
                    id: loggedInUserId,
                    email: rememberedEmail || 'User',
                    name: userData ? userData.name : ''
                });
                // Initialize notifications for regular user
                initializeNotificationsForUser({
                    id: loggedInUserId,
                    email: rememberedEmail || 'User',
                    name: userData ? userData.name : ''
                });
            }
        } catch (error) {
            console.error("Error checking user status:", error);
            // Fallback to regular user interface
            showRegisteredUserInterface({
                id: loggedInUserId,
                email: rememberedEmail || 'User'
            });
            // Initialize notifications with basic user info
            initializeNotificationsForUser({
                id: loggedInUserId,
                email: rememberedEmail || 'User'
            });
        }
    } else {
        // User is not registered - show non-registered interface
        console.log("Showing non-registered user interface");
        showNonRegisteredUserInterface();
        
        // Setup notifications dropdown for non-logged in users (will redirect to login)
        setupNotificationsDropdown();
    }
}

// Make functions available globally
window.viewNotification = viewNotification;
window.markNotificationAsRead = markNotificationAsRead;

      
    </script>
  </body>
</html>
